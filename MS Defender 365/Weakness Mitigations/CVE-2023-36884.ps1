<# https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-36884 #>
#Workflow
WorkFlow Set-RegistryItems{
	param($Path,$RegistryItemsPath,$Name,$Type,$Value,$RegType,$RegistryArguments
	)
#Functions
Function New-Key {
	param($Path,$Name)
	New-Item -path $Path -Name $Name -ea SilentlyContinue | Out-Null
}
Function New-RegItem{
	param($Path,$Name,$RegType,$Value)
	New-ItemProperty -Path $Path -Name $Name -PropertyType $RegType -Value $Value -ea SilentlyContinue | Out-null
}
If($Type -eq 'New'){
	New-Key -Path $Path -Name $Name
	Write-Output 'Key created,adding registry items'
		ForEach($RegistryArgument in $RegistryArguments){
			New-RegItem -Path $RegistryItemsPath -Name $RegistryArgument -PropertyType $RegType -Value $Value
			Write-Output "$RegistryArgument created in $RegistryItemsPath"
		}
}
If($Type -eq 'Set'){
			ForEach($RegistryArgument in $RegistryArguments){
			New-RegItem -Path $RegistryItemsPath -Name $RegistryArgument -PropertyType $RegType -Value $Value
			Write-Output "$RegistryArgument created in $RegistryItemsPath"
		}
}
}
#Values
$Path = 'HKLM:\Software\Policies\Microsoft\Internet Explorer\Main\FeatureControl'
$RegistryItemsPath = "$Path\FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION"
$RegistryArguments = @('Excel.exe','Graph.exe','MSAccess.exe','MSPub.exe','Powerpnt.exe','Visio.exe','WinProj.exe','WinWord.exe','Wordpad.exe')
#Conditions
If((test-path $RegistryItemsPath) -eq $False){
	Set-RegistryItems -Path $Path -RegistryItemsPath $RegistryItemsPath -RegistryArguments $RegistryArguments -Name 'FEATURE_BLOCK_CROSS_PROTOCOL_FILE_NAVIGATION' -Type 'New' -RegType DWORD -Value 1
}Else{
	Set-RegistryItems -Path $Path -RegistryItemsPath $RegistryItemsPath -RegistryArguments $RegistryArguments -Type 'Set' -RegType DWORD -Value 1
}
