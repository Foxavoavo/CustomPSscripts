<# 
    Windows PrintNightmare Registry Exposure CVE-2021-34527 OOB Security Update RCE (July 2021)

- HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint ========>>>> If exist
- HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint\NoWarningNoElevationOnInstall set to =======>>>> 0
- HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint\UpdatePromptSettings set to =======>>>> 0
- HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint\RestrictDriverInstallationToAdministrators set to =======>>>> 1

Abobe settings for compliance
#>
 #reg housekeep                                                                                       
 $a = get-itemproperty -Path "HKLM:SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint" 
    If($a -ne $null){$path = "HKLM:SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint"
                     Set-itemproperty $path RestrictDriverInstallationToAdministrators -Value 1 -ea SilentlyContinue
                      "change value in RestrictDriverInstallationToAdministrators to 1"
                     If($a.NoWarningNoElevationOnInstall -ne 0){"Setting NoWarningNoElevationOnInstall to 0"
                                                                Set-itemproperty $path NoWarningNoElevationOnInstall -Value 0 -ea SilentlyContinue
                                                                }
                      If($a.UpdatePromptSettings -ne 0){"Setting UpdatePromptSettings to 0"
                                                        Set-itemproperty $path UpdatePromptSettings -Value 0 -ea SilentlyContinue
                                                        }
                     }
    Else{"No keys found"}    
